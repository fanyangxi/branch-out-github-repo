#!/usr/bin/env node

'use strict'

const path = require('path')
const program = require('commander');
const { branchOut } = require(path.join(__dirname, '../src/create-new-branch'))

// Local(s):
const commandName = "branch-out";

// Common setup for program:
program
  .option('-d, --debug', 'output extra debugging')
  .option("-v, --verbose", "Indicates more logging")

// Command 1: af5c1f1815b65a34a21993adec7064f9ac2d9a9e
program
    .command('release <target-repo>')
    .description('Create a release branch')
    .option("-s, --source-revision-sha <source-revision-sha/branch-name>", "source-revision-sha or the branch you want to branch out from", "master")
    .option("-d, --destination-repo <destination-repo>", "destination-repo", "release")
    .action(function (targetRepo, options) {
        branchOut(targetRepo, options.sourceRevisionSha, options.destinationRepo);
    })
    .helpOption('-h, --HELP', function() {
        console.log('');
        console.log('Examples:');
        console.log('');
        console.log(`  $ ${commandName} release TARGET-REPO-NAME`);
    });

// Command 2:
program
    .command('tag <target-repo>')
    .description('Create a release branch')
    .option("-n, --tag-number <tag-number>", "The tag number to be used")
    .action(function (options) {
        console.log(options.exec_mode);
    })
    .helpOption('-h, --HELP', function() {
        console.log('');
        console.log('Examples:');
        console.log('');
        console.log(`  $ ${commandName} release -r TARGET-REPO-NAME`);
    });

program
    .command('*')
    .action(function (env) {
        console.log('Unrecognaized command');
    });

program.parse(process.argv);