#!/usr/bin/env node

'use strict'

const path = require('path')
const program = require('commander');
const { branchOut } = require(path.join(__dirname, '../src/create-new-branch'))

// Local(s):
const commandName = "branch-out";

// Common setup for program:
program
  .option('-d, --debug', 'output extra debugging');

// Command 1: af5c1f1815b65a34a21993adec7064f9ac2d9a9e
program
    .command("release <target-repo>")
    .description('Create a release branch. TARGET-REPO should be in format (:owner/:repo) EG.: nodejs/node-gyp')
    .requiredOption("-t, --github-token <github-token>", "Your github token")
    .requiredOption("-s, --source-revision-sha <source-revision-sha/branch-name>", "source-revision-sha or the branch you want to branch out from", "master")
    .requiredOption("-d, --destination-repo <destination-repo>", "destination-repo", "release")
    .action(function (targetRepo, options) {
        branchOut(options.githubToken, targetRepo, options.sourceRevisionSha, options.destinationRepo);
    });

// Command 2:
program
    .command('tag <target-repo>')
    .description('Create a tag')
    .option("-n, --tag-number <tag-number>", "The tag number to be used")
    .action(function (options) {
        console.log(options.exec_mode);
    });

program
    .command('*')
    .action(function (env) {
        console.log('Unrecognized command');
    });

program.parse(process.argv);